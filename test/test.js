'use strict';

var expect = require('expect.js'),
    geos = require('./geo.json');
//load expect-maptalks
require('../index');

describe('expect-maptalks tests', function () {
    describe('approx', function () {
        it('approx', function () {
            expect(118.85893323889732).to.be.approx(118.85893323889712);
        });
    });

    describe('closeTo', function () {
        it('closeTo', function () {
            expect([1, 1]).to.be.closeTo([1 + 1E-7, 1 - 1E-7]);
            expect({ x : 1, y : 1 }).to.be.closeTo([1 + 1E-7, 1 - 1E-7]);
        });

        it('not closeTo', function () {
            expect([1, 1]).not.to.be.closeTo([1 + 1E-5, 1 - 1E-7]);
            expect([1, 1]).not.to.be.closeTo(null);
            expect(null).not.to.be.closeTo([1 + 1E-7, 1 - 1E-7]);
        });
    });

    describe('eqlGeoJSON', function () {
        it('eqlGeoJSON', function () {
            geos.forEach(function (g, index) {
                expect(g).to.be.eqlGeoJSON(g);
                expect(null).not.to.be.eqlGeoJSON(g);
                expect(g).not.to.be.eqlGeoJSON(null);
                if (index > 0) {
                    expect(g).not.to.be.eqlGeoJSON(geos[index - 1]);
                }
            });
        });

        it('2 polygons', function () {
            var polygon1 = { 'type':'Feature', 'geometry':{ 'type':'Polygon', 'coordinates':[[[118.85894485601783, 32.056534], [118.85893324755226, 32.05672179903236], [118.85889854054363, 32.05690754049922], [118.85884111511369, 32.057089189378196], [118.85876160030405, 32.057264755486166], [118.85866086718966, 32.05743231528412], [118.85854001933987, 32.057590032951815], [118.85840038073103, 32.0577361805015], [118.85824348124326, 32.05786915671005], [118.85807103990028, 32.05798750466228], [118.85788494603506, 32.05808992771327], [118.85768723858897, 32.058175303694625], [118.85748008376983, 32.05824269720924], [118.85726575131514, 32.058291369879655], [118.85704658961956, 32.05832078843793], [118.85682500000001, 32.05833063056817], [118.85660341038044, 32.05832078843793], [118.85638424868486, 32.058291369879655], [118.85616991623017, 32.05824269720924], [118.85596276141106, 32.058175303694625], [118.85576505396494, 32.05808992771327], [118.85557896009972, 32.05798750466228], [118.85540651875674, 32.05786915671005], [118.85524961926897, 32.0577361805015], [118.85510998066013, 32.057590032951815], [118.85498913281035, 32.05743231528412], [118.85488839969597, 32.057264755486166], [118.85480888488631, 32.057089189378196], [118.85475145945637, 32.05690754049922], [118.85471675244774, 32.05672179903236], [118.85470514398217, 32.056534], [118.85471676110268, 32.05634620096764], [118.85475147638797, 32.05616045950078], [118.8548089093546, 32.05597881062181], [118.85488843063156, 32.05580324451383], [118.8549891688612, 32.05563568471589], [118.85511002025066, 32.05547796704819], [118.85524966066889, 32.05533181949849], [118.85540656015661, 32.05519884328995], [118.85557899969025, 32.05508049533771], [118.85576509001578, 32.05497807228674], [118.85596279234663, 32.05489269630538], [118.85616994069846, 32.05482530279076], [118.85638426561646, 32.054776630120344], [118.85660341903537, 32.05474721156207], [118.85682500000001, 32.054737369431834], [118.85704658096464, 32.05474721156207], [118.85726573438355, 32.054776630120344], [118.85748005930154, 32.05482530279076], [118.85768720765337, 32.05489269630538], [118.85788490998422, 32.05497807228674], [118.85807100030975, 32.05508049533771], [118.85824343984339, 32.05519884328995], [118.85840033933111, 32.05533181949849], [118.85853997974935, 32.05547796704819], [118.8586608311388, 32.05563568471589], [118.85876156936844, 32.05580324451383], [118.85884109064541, 32.05597881062181], [118.85889852361203, 32.05616045950078], [118.85893323889732, 32.05634620096764]]] }, 'properties':null };
            var polygon2 = { 'type':'Feature', 'geometry':{ 'type':'Polygon', 'coordinates':[[[118.85894485601763, 32.05653399999999], [118.85893324755206, 32.05672179903235], [118.85889854054344, 32.05690754049921], [118.85884111511349, 32.05708918937819], [118.85876160030385, 32.05726475548616], [118.85866086718946, 32.0574323152841], [118.85854001933967, 32.05759003295181], [118.8584003807308, 32.0577361805015], [118.85824348124306, 32.05786915671005], [118.85807103990008, 32.05798750466228], [118.85788494603486, 32.058089927713254], [118.85768723858874, 32.05817530369461], [118.85748008376962, 32.05824269720923], [118.85726575131494, 32.05829136987965], [118.85704658961934, 32.058320788437925], [118.85682499999979, 32.05833063056816], [118.85660341038025, 32.058320788437925], [118.85638424868465, 32.05829136987965], [118.85616991622997, 32.05824269720923], [118.85596276141084, 32.05817530369461], [118.85576505396473, 32.058089927713254], [118.85557896009952, 32.05798750466228], [118.85540651875651, 32.05786915671005], [118.85524961926878, 32.0577361805015], [118.85510998065993, 32.05759003295181], [118.85498913281015, 32.0574323152841], [118.85488839969577, 32.05726475548616], [118.85480888488611, 32.05708918937819], [118.85475145945617, 32.05690754049921], [118.85471675244754, 32.05672179903235], [118.85470514398196, 32.05653399999999], [118.85471676110248, 32.05634620096764], [118.85475147638778, 32.056160459500774], [118.85480890935439, 32.055978810621795], [118.85488843063135, 32.05580324451383], [118.85498916886098, 32.05563568471588], [118.85511002025045, 32.055477967048176], [118.85524966066869, 32.05533181949849], [118.85540656015641, 32.05519884328994], [118.85557899969005, 32.05508049533771], [118.85576509001558, 32.05497807228673], [118.85596279234643, 32.05489269630537], [118.85616994069827, 32.05482530279076], [118.85638426561626, 32.05477663012034], [118.85660341903517, 32.054747211562066], [118.85682499999979, 32.05473736943183], [118.85704658096444, 32.054747211562066], [118.85726573438335, 32.05477663012034], [118.85748005930134, 32.05482530279076], [118.85768720765317, 32.05489269630537], [118.85788490998401, 32.05497807228673], [118.85807100030955, 32.05508049533771], [118.85824343984319, 32.05519884328994], [118.85840033933091, 32.05533181949849], [118.85853997974914, 32.055477967048176], [118.85866083113861, 32.05563568471588], [118.85876156936824, 32.05580324451383], [118.8588410906452, 32.055978810621795], [118.85889852361183, 32.056160459500774], [118.85893323889712, 32.05634620096764]]] }, 'properties':null };
            expect(polygon1).to.be.eqlGeoJSON(polygon2);
        });
    });

    describe('painted', function () {
        it('painted', function () {
            //TODO
        });
    });
});
